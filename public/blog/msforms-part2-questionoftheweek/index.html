<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="http://www.burgersandbytes.nl" rel="canonical" />

  <link rel="icon" href="favicon.png">

  <title>
  Microsoft Forms automation: update Forms poll on SharePoint intranet - part 2 - Burgers &amp; Bytes
  </title>
  <meta name="description" content="Keep your ‘Question of the week’ based on Microsoft up-to-date" />
  <meta name="keywords" content="Power Automate,custom connector,Microsoft Forms,SharePoint intranet,Poll" />
  <meta name="generator" content="Hugo 0.128.2">
  <link rel="stylesheet" href="/css/styles.css" />
  
  

  <meta property="og:title" content="Microsoft Forms automation: update Forms poll on SharePoint intranet - part 2" />
<meta property="og:description" content="Keep your ‘Question of the week’ based on Microsoft up-to-date" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//aseURL:1313/blog/msforms-part2-questionoftheweek/" /><meta property="og:image" content="//aseURL:1313/00FormsQuestion.png" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2023-08-15T00:00:02+00:00" />
<meta property="article:modified_time" content="2023-08-15T00:00:02+00:00" />


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//aseURL:1313/00FormsQuestion.png">
  <meta name="twitter:title" content="Microsoft Forms automation: update Forms poll on SharePoint intranet - part 2">
  <meta name="twitter:description" content="Keep your ‘Question of the week’ based on Microsoft up-to-date">

  
  <meta itemprop="name" content="Microsoft Forms automation: update Forms poll on SharePoint intranet - part 2">
  <meta itemprop="description" content="Keep your ‘Question of the week’ based on Microsoft up-to-date">
  <meta itemprop="datePublished" content="2023-08-15T00:00:02+00:00">
  <meta itemprop="dateModified" content="2023-08-15T00:00:02+00:00">
  <meta itemprop="wordCount" content="706">
  <meta itemprop="image" content="//aseURL:1313/00FormsQuestion.png">
  <meta itemprop="keywords" content="Power Automate,custom connector,Microsoft Forms,SharePoint intranet,Poll">

 

  

  
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="//aseURL:1313/" class="capitalize font-extrabold text-2xl">
    
    <img src="/logo.png" alt="Burgers &amp; Bytes" class="max-w-full" style="height:75px" />
    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">

    
    <li><a href="/">Home</a></li>
    
    <li><a href="/blog/">Blog</a></li>
    
    <li><a href="/page/about/">About</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
  </ul>
</header>
<main class="flex-1">
  
  

  
  
    <div class="relative max-w-xl mx-auto px-4">
    <img src="/images/MSForms/Part2-QuestionoftheWeek/00FormsQuestion.png" class="rounded-lg shadow-sm w-full object-contain" />
    
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      
  
    August 15, 2023
  


    </div>
    
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Microsoft Forms automation: update Forms poll on SharePoint intranet - part 2</h1>
    
    <h5 class="text-sm flex items-center flex-wrap">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Aug 15, 2023 
      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      4&nbsp;
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      706&nbsp;
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4">
        

        
        <li>
        <a href="#set-up-sharepoint-list">Set up SharePoint list</a>
        

        
        </li><li>
        <a href="#flow-trigger-and-variables">Flow trigger and variables</a>
        

        
        </li><li>
        <a href="#check-new-question-for-today">Check new question for today</a>
        

        
        </li><li>
        <a href="#get-information-of-question-that-needs-to-be-added">Get information of question that needs to be added</a>
        

        
        </li><li>
        <a href="#get-current-active-question-to-store-results">Get current active question to store results</a>
        

        
        </li><li>
        <a href="#delete-responses">Delete responses</a>
        

        
        </li><li>
        <a href="#convert-answer-options">Convert answer options</a>
        

        
        </li><li>
        <a href="#update-sharepoint-list-with-question-id">Update SharePoint list with question id</a>
        

        
        </li><li>
        <a href="#something-to-consider">Something to consider</a>
        </li></ul>
  </details>

    <p>Creating a social intranet that fosters collaboration and engagement among employees is essential in today&rsquo;s digital workplace. One effective component of a social intranet is a &ldquo;question of the week&rdquo; or poll functionality. While SharePoint doesn&rsquo;t have a built-in poll feature, you can use a Microsoft Form with one question to achieve the same effect. However, updating the question weekly can be a manual and time-consuming task.</p>
<p>Unfortunately, Microsoft doesn&rsquo;t provide a standard API for Microsoft Forms that can easily be integrated with Power Automate to automate question creation and management of a Form. In the first part of this blog series there is explained how to create a custom connector for Microsoft Forms. This custom connector with related actions will be used in this blog.</p>
<p>SharePoint doesn’t have an out-of-the-box functionality to create a poll: by using a Microsoft Form with just one question it’s possible to have the same experience.</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/1-Intranet.png" alt="Intranet"></p>
<p>The kind of question can vary from question around topics like how employee spend their holidays or more serious topics to focus attention on it.</p>
<p>Often a communication department has prepared a stock of questions after a brainstorming session, so they don’t have to think about it every week. How nice would it be if these were also automatically updated every week on the intranet!
Currently, Power Automate only has an action available that receives responses from a Microsoft Forms, no ability to create questions on a Form.</p>
<p><a href="/blog/msforms-part1-customconnector/">In the first part of this blog series</a>
 a custom connector using the undocumented Microsoft Forms API is created.</p>
<p>The High Level Design of the steps described in this blog:</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/HLD.png" alt="High Level Design"></p>
<h2 id="set-up-sharepoint-list">Set up SharePoint list</h2>
<p>Create a SharePoint list adding the following columns:</p>
<table>
<thead>
<tr>
<th>Columnname</th>
<th>Column type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Question</td>
<td>Single line of text (you can use/rename the title column)</td>
</tr>
<tr>
<td>AnswerOptions</td>
<td>Multiple line of text (description: enter answer options separated by &lsquo;|&rsquo;)</td>
</tr>
<tr>
<td>StartDate</td>
<td>Date (to be sure no two items are created with same starting date, set this column to contain unique values)</td>
</tr>
<tr>
<td>QuestionID</td>
<td>Single line of text</td>
</tr>
<tr>
<td>Results</td>
<td>Multiline of text</td>
</tr>
</tbody>
</table>
<p>The SharePoint list looks like this:</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/2-SPlist.png" alt="SharePoint list"></p>
<h2 id="flow-trigger-and-variables">Flow trigger and variables</h2>
<p>Create a ‘Scheduled cloud flow’. Set the recurrence on daily.
Start with initializing the variables:</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/3-FlowVariables.png" alt="Flow initialize variables"></p>
<h2 id="check-new-question-for-today">Check new question for today</h2>
<p>Next step is to get the item of the SharePoint list in which the StartDate is equal to todays date. If there are no items, the Flow can be terminated.</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/4-ConditionStartDate.png" alt="Condition start date"></p>
<h2 id="get-information-of-question-that-needs-to-be-added">Get information of question that needs to be added</h2>
<p>Next steps are to store the results of the current available AnswerOptions and get the current active question id and store that one in a variable.</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/5-FormsChoiceData.png" alt="FormsChoiceData"></p>
<h2 id="get-current-active-question-to-store-results">Get current active question to store results</h2>
<p>Get the question that is currently active to get the QuestionID.</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/6-QuestionID.png" alt="QuestionID"></p>
<p>Based on the QuestionId get the related item ID in the SharePoint list and update that item with the results.</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/7-SPResultsUpdate.png" alt="SP Result update"></p>
<h2 id="delete-responses">Delete responses</h2>
<p>Next steps are needed to update the Form with a new question, first the responses have to be deleted in order to give everyone the ability to respond on the new question and the old question needs to deleted.</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/8-DeleteResponses.png" alt="Delete Responses"></p>
<h2 id="convert-answer-options">Convert answer options</h2>
<p>The new question needs to be retrieved and AnswerOptions needs to be formatted in usable format.</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/9-NewQuestion.png" alt="New Question"></p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/10-ChoicesToGenerate.png" alt="Choices to Generate"></p>
<p>The variable varChoicestoGenerate needs to be formatted a bit, using the following expression:</p>
<p><code>@{replace(substring(variables('varChoicestoGenerate'),0, int(lastIndexOf(variables('varChoicestoGenerate'),','))),'\n','')}</code></p>
<p>The id is determined by the expression: <code>@{concat('r',string(rand(10000,999999)))}</code></p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/11-PostQuestion.png" alt="Post Question"></p>
<h2 id="update-sharepoint-list-with-question-id">Update SharePoint list with question id</h2>
<p>Last step is to store the question id in the SharePoint list:</p>
<p><img src="/images/MSForms/Part2-QuestionoftheWeek/12-UpdateSPlist.png" alt="Update SharePoint list"></p>
<p>The Flow is ready to run every day to verify if a new question of the week needs to be posted on the intranet.
Not only the new question is added, also the results of the previous questions are stored into the SharePoint list.</p>
<h2 id="something-to-consider">Something to consider</h2>
<p>The use of a custom connector makes it really easy to use to actions into multiple Flows, without technical knowledge needed.
The disadvantages is the fact that you need a premium license to perform those actions.
In this scenario the API calls can be done using &lsquo;Send an HTTP request to SharePoint&rsquo; as well.</p>
<p>Hereby one example for posting a new question:</p>
<p><img src="/images/MSForms/Part1-CustomConnector/13-PostHTTPSharePoint.png" alt="HTTP Request to SharePoint"></p>
<p><a href="/blog/msforms-part3-dashboard/">In the last part of this blog series</a>
 you can read how to visualize the data from the SharePoint list into a Power BI dashboard.</p>

  </article>

  
<div class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'burgersandbytes';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



  
  
</div>

<div style="background: #92400E;">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
    <div>
      <div class="text-3xl font-bold mb-2">Empowering productivity - one blog at a time!</div>
      <p class="opacity-60"></p>
    </div>

    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2">
      

      
      <li>
        <a href="https://twitter.com/elianne_tweets" target="_blank" rel="noopener" aria-label="Twitter"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1668.56 1221.19" width="24" height="24"
            stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M283.94,167.31l386.39,516.64L281.5,1104h87.51l340.42-367.76L984.48,1104h297.8L874.15,558.3l361.92-390.99
  h-87.51l-313.51,338.7l-253.31-338.7H283.94z M412.63,231.77h136.81l604.13,807.76h-136.81L412.63,231.77z" />

          </svg>
        </a>
      </li>
      

      

      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a href="https://nl.linkedin.com/in/elianne-b-48946864" target="_blank" rel="noopener" aria-label="LinkedIn"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      


      
      <li>
        <a href="https://www.burgersandbytes.nl/index.xml" target="_blank" rel="noopener" aria-label="rss"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="-125 -100 712 712" width="24" height="24"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
  <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/>
<path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/>
<path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/>
        </svg>

        


        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright © 2025 - Elianne Burgers · All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none"  stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12"  />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="//aseURL:1313/js/scripts.min.js"></script>


  







<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
