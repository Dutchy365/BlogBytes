<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="http://www.burgersandbytes.nl" rel="canonical" />

  <link rel="icon" href="favicon.png">

  <title>
  Dynamics forms: tabular question type - Burgers &amp; Bytes
  </title>
  <meta name="description" content="How to create flexible tabular questions" /><meta name="generator" content="Hugo 0.128.2">
  <link rel="stylesheet" href="/css/styles.css" />
  
  

  <meta property="og:title" content="Dynamics forms: tabular question type" />
<meta property="og:description" content="How to create flexible tabular questions" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//aseURL:1313/blog/20240605-dynamicformstabular/" /><meta property="og:image" content="//aseURL:1313/00DynamicForms.png" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2024-06-05T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-06-05T00:00:00+00:00" />


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//aseURL:1313/00DynamicForms.png">
  <meta name="twitter:title" content="Dynamics forms: tabular question type">
  <meta name="twitter:description" content="How to create flexible tabular questions">

  
  <meta itemprop="name" content="Dynamics forms: tabular question type">
  <meta itemprop="description" content="How to create flexible tabular questions">
  <meta itemprop="datePublished" content="2024-06-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-06-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="871">
  <meta itemprop="image" content="//aseURL:1313/00DynamicForms.png">
  <meta itemprop="keywords" content="Power Apps,Dynamic Forms,ParseJSON">

 

  

  
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="//aseURL:1313/" class="capitalize font-extrabold text-2xl">
    
    <img src="/logo.png" alt="Burgers &amp; Bytes" class="max-w-full" style="height:75px" />
    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">

    
    <li><a href="/">Home</a></li>
    
    <li><a href="/blog/">Blog</a></li>
    
    <li><a href="/page/about/">About</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
  </ul>
</header>
<main class="flex-1">
  
  

  
  
    <div class="relative max-w-xl mx-auto px-4">
    <img src="/images/20240605DynamicFormsTabular/00DynamicForms.png" class="rounded-lg shadow-sm w-full object-contain" />
    
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      
  
    June 5, 2024
  


    </div>
    
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Dynamics forms: tabular question type</h1>
    
    <h5 class="text-sm flex items-center flex-wrap">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Jun 5, 2024 
      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      5&nbsp;
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      871&nbsp;
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4">
        

        
        <li>
        <a href="#dynamics-forms">Dynamics Forms</a>
        

        
        </li><li>
        <a href="#end-result">End result</a>
        

        
        </li><li>
        <a href="#define-column-headers">Define column headers</a>
        

        
        </li><li>
        <a href="#question-setup">Question setup</a>
        

        
        <ul>
            <li>
        <a href="#header">Header</a>
        

        
        </li><li>
        <a href="#form">Form</a>
        

        
        </li><li>
        <a href="#answer-gallery">Answer gallery</a>
        

        
        </li></ul>
      </li><li>
        <a href="#answers">Answers</a>
        

        
        <ul>
            <li>
        <a href="#add-answers">Add answers</a>
        

        
        </li><li>
        <a href="#remove-answers">Remove answers</a>
        

        
        </li><li>
        <a href="#pre-load-previous-answers">Pre-load previous answers</a>
        

        
        </li></ul>
      </li><li>
        <a href="#patch">Patch</a>
        

        
        </li><li>
        <a href="#tips-and-tricks">Tips and tricks</a>
        </li></ul>
  </details>

    <h2 id="dynamics-forms">Dynamics Forms</h2>
<p>Inspired by <a href="https://www.matthewdevaney.com/power-apps-dynamic-forms-generate-forms-from-a-questions-list/" target="_blank" rel="noopener">Matthey Devaney</a>
, a fully dynamic form was created in Power Apps, incorporating various question types like toggles, text inputs, and comboboxes. Everything worked smoothly until the need for tabular questions came along.</p>
<p>For these tabular questions, the requirement was to allow flexible setup of the question and definition of table headers, enabling end users to enter their answers in the rows below. This challenge is now ready to be addressed üí™üèª.</p>
<h2 id="end-result">End result</h2>
<p>The end result is the possibility to answer tabular question in which the user can add and remove answers.</p>
<p><img src="/images/20240605DynamicFormsTabular/1-endresult.gif" alt="End result"></p>
<h2 id="define-column-headers">Define column headers</h2>
<p>Management of the questions takes place in a Model Driven app.
The question is defined and the column headers are entered as options formatted using comma separated values.</p>
<p><img src="/images/20240605DynamicFormsTabular/2-Options.png" alt="Options"></p>
<p>The limitations in the Power Apps Canvas are set to work with a maximum of 5 column headers. In this example question there are just 3 column headers needed.</p>
<p>A collection &lsquo;colTabularAnswers&rsquo; is created to store the information for all questions of type &rsquo;tabular&rsquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>Clear(colTabularAnswers);
</span></span><span style="display:flex;"><span>    ForAll(
</span></span><span style="display:flex;"><span>        Filter(colQuestions,FieldType = <span style="color:#f1fa8c">&#34;Tabular&#34;</span>) As data,
</span></span><span style="display:flex;"><span>            With({splitted: Split(data.Options, <span style="color:#ff79c6">&#34;,&#34;</span>)},
</span></span><span style="display:flex;"><span>            Collect(
</span></span><span style="display:flex;"><span>                colTabularAnswers,
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    QuestionID: data.QuestionID,
</span></span><span style="display:flex;"><span>                    ID: GUID(),
</span></span><span style="display:flex;"><span>                    ColumnType: 0, 
</span></span><span style="display:flex;"><span>                    Column1: If(CountRows(splitted) &gt;= 1,
</span></span><span style="display:flex;"><span>                        Text(Index(splitted,1).Value),
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&#34; &#34;</span>),
</span></span><span style="display:flex;"><span>                    Column2: If(CountRows(splitted) &gt;= 2,
</span></span><span style="display:flex;"><span>                        Text(Index(splitted,2).Value),
</span></span><span style="display:flex;"><span>                         <span style="color:#ff79c6">&#34; &#34;</span>),
</span></span><span style="display:flex;"><span>                    Column3: If(CountRows(splitted) &gt;= 3,
</span></span><span style="display:flex;"><span>                        Text(Index(splitted,3).Value),
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&#34; &#34;</span>),
</span></span><span style="display:flex;"><span>                    Column4: If(CountRows(splitted) &gt;= 4,
</span></span><span style="display:flex;"><span>                        Text(Index(splitted,4).Value),
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&#34; &#34;</span>),
</span></span><span style="display:flex;"><span>                    Column5: If(CountRows(splitted) &gt;= 5,
</span></span><span style="display:flex;"><span>                        Text(Index(splitted,5).Value),
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&#34; &#34;</span>)
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>        ));
</span></span></code></pre></div><p>This results in a collection in which for all questions with fieldtype tabular the column headers are defined. By ColumnType = 0 it&rsquo;s known as header.
<img src="/images/20240605DynamicFormsTabular/3-Headers.png" alt="Headers"></p>
<h2 id="question-setup">Question setup</h2>
<p>In the gallery in which all questions types are covered a container is added which three different parts: header, form and answers. As you can see a maximum of 5.
<img src="/images/20240605DynamicFormsTabular/4a-container.png" alt="container">
<img src="/images/20240605DynamicFormsTabular/4b-container.png" alt="container"></p>
<h3 id="header">Header</h3>
<p>The column headers are set as text:
<img src="/images/20240605DynamicFormsTabular/5-headertext.png" alt="header text"></p>
<h3 id="form">Form</h3>
<p>The form is created using text input.</p>
<p><img src="/images/20240605DynamicFormsTabular/6-forminput.png" alt="form"></p>
<p>The visibility of each TabularValue is set based on the number of column headers available as options:
<code>If(CountRows(Split(ThisItem.Options,&quot;,&quot;)) &gt;= 1,true, false)</code></p>
<h3 id="answer-gallery">Answer gallery</h3>
<p>In the galTabular the answers of the current questions are loaded.
The items:
<code>Filter(colTabularAnswers, QuestionID = ThisItem.QuestionID And ColumnType = 1) As Tabular</code></p>
<p><img src="/images/20240605DynamicFormsTabular/7-galAnswers.png" alt="galAnswers"></p>
<p>In this example there are just three columns available, to equally divided the columns the width of the label is calculated dynamically.</p>
<p>Width:
<code>If(CountRows(Split(ThisItem.Options,&quot;,&quot;)) = 0, &quot;&quot;, (Parent.Width - btnTabularFormAdd.Width) / (CountRows(Split(ThisItem.Options,&quot;,&quot;))))</code></p>
<h2 id="answers">Answers</h2>
<p>The answers need to be initially stored, deleted and reloaded.</p>
<h3 id="add-answers">Add answers</h3>
<p>Not only the answers needed to be given, they need to be saved as well.
After clicking on the Add button the collection is updated with the entered values.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>Patch(
</span></span><span style="display:flex;"><span>    colTabularAnswers,
</span></span><span style="display:flex;"><span>    Defaults(colTabularAnswers),
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ID: GUID(),
</span></span><span style="display:flex;"><span>        QuestionID: ThisItem.QuestionID,
</span></span><span style="display:flex;"><span>        ColumnType: 1,
</span></span><span style="display:flex;"><span>        Column1: If(IsBlank(txtTabularForm1.Value), <span style="color:#ff79c6">&#34; &#34;</span>, txtTabularForm1.Value),
</span></span><span style="display:flex;"><span>        Column2: If(IsBlank(txtTabularForm2.Value), <span style="color:#ff79c6">&#34; &#34;</span>, txtTabularForm2.Value),
</span></span><span style="display:flex;"><span>        Column3: If(IsBlank(txtTabularForm3.Value), <span style="color:#ff79c6">&#34; &#34;</span>, txtTabularForm3.Value),
</span></span><span style="display:flex;"><span>        Column4: If(IsBlank(txtTabularForm4.Value), <span style="color:#ff79c6">&#34; &#34;</span>, txtTabularForm4.Value),
</span></span><span style="display:flex;"><span>        Column5: If(IsBlank(txtTabularForm5.Value), <span style="color:#ff79c6">&#34; &#34;</span>, txtTabularForm5.Value)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Reset(txtTabularForm<span style="color:#bd93f9">1</span>);
</span></span><span style="display:flex;"><span>Reset(txtTabularForm<span style="color:#bd93f9">2</span>);
</span></span><span style="display:flex;"><span>Reset(txtTabularForm<span style="color:#bd93f9">3</span>);
</span></span><span style="display:flex;"><span>Reset(txtTabularForm<span style="color:#bd93f9">4</span>);
</span></span><span style="display:flex;"><span>Reset(txtTabularForm<span style="color:#bd93f9">5</span>);
</span></span><span style="display:flex;"><span>Reset(galTabular);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>UpdateIf(
</span></span><span style="display:flex;"><span>    colQuestionsModified, QuestionID = ThisItem.QuestionID,
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        Modified: 1,
</span></span><span style="display:flex;"><span>        Answer: Text(JSON(Filter(colTabularAnswers As data, data.QuestionID = ThisRecord.QuestionID)))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>The given values are added to the collection and next to that the colQuestionsModified in which all modified answers are stored is updated.<br>
The answer is stored as text which looks like JSON. Due to the fact PowerFx doesn&rsquo;t have the opportunity to create dynamic column value, the &lsquo;Column1&rsquo;, &lsquo;Column2&rsquo; etcetera are introduced.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;Column1&#34;</span>:<span style="color:#f1fa8c">&#34;Training/Certification&#34;</span>,<span style="color:#ff79c6">&#34;Column2&#34;</span>:<span style="color:#f1fa8c">&#34; Institution&#34;</span>,<span style="color:#ff79c6">&#34;Column3&#34;</span>:<span style="color:#f1fa8c">&#34; Year completed&#34;</span>,<span style="color:#ff79c6">&#34;Column4&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;Column5&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;ColumnType&#34;</span>:<span style="color:#bd93f9">0</span>,<span style="color:#ff79c6">&#34;ID&#34;</span>:<span style="color:#f1fa8c">&#34;4d658e27-a765-4179-af59-b6883fd1c7a0&#34;</span>,<span style="color:#ff79c6">&#34;QuestionID&#34;</span>:<span style="color:#f1fa8c">&#34;58935396-891d-ef11-840a-002248a269cd&#34;</span>},
</span></span><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;Column1&#34;</span>:<span style="color:#f1fa8c">&#34;Scrum master&#34;</span>,<span style="color:#ff79c6">&#34;Column2&#34;</span>:<span style="color:#f1fa8c">&#34;Scrum.org&#34;</span>,<span style="color:#ff79c6">&#34;Column3&#34;</span>:<span style="color:#f1fa8c">&#34;2022&#34;</span>,<span style="color:#ff79c6">&#34;Column4&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;Column5&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;ColumnType&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#ff79c6">&#34;ID&#34;</span>:<span style="color:#f1fa8c">&#34;22d3907e-f7ca-4cfa-af4c-3316e2888788&#34;</span>,<span style="color:#ff79c6">&#34;QuestionID&#34;</span>:<span style="color:#f1fa8c">&#34;58935396-891d-ef11-840a-002248a269cd&#34;</span>},
</span></span><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;Column1&#34;</span>:<span style="color:#f1fa8c">&#34;PL-100&#34;</span>,<span style="color:#ff79c6">&#34;Column2&#34;</span>:<span style="color:#f1fa8c">&#34;Microsoft&#34;</span>,<span style="color:#ff79c6">&#34;Column3&#34;</span>:<span style="color:#f1fa8c">&#34;2023&#34;</span>,<span style="color:#ff79c6">&#34;Column4&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;Column5&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;ColumnType&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#ff79c6">&#34;ID&#34;</span>:<span style="color:#f1fa8c">&#34;0138e7c9-6e85-4e35-9cd7-0f85bd38c438&#34;</span>,<span style="color:#ff79c6">&#34;QuestionID&#34;</span>:<span style="color:#f1fa8c">&#34;58935396-891d-ef11-840a-002248a269cd&#34;</span>},
</span></span><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;Column1&#34;</span>:<span style="color:#f1fa8c">&#34;PL-200&#34;</span>,<span style="color:#ff79c6">&#34;Column2&#34;</span>:<span style="color:#f1fa8c">&#34;Microsoft&#34;</span>,<span style="color:#ff79c6">&#34;Column3&#34;</span>:<span style="color:#f1fa8c">&#34;2024&#34;</span>,<span style="color:#ff79c6">&#34;Column4&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;Column5&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;ColumnType&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#ff79c6">&#34;ID&#34;</span>:<span style="color:#f1fa8c">&#34;34aa3e5c-188a-4914-991f-71801b5ff97f&#34;</span>,<span style="color:#ff79c6">&#34;QuestionID&#34;</span>:<span style="color:#f1fa8c">&#34;58935396-891d-ef11-840a-002248a269cd&#34;</span>}
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><h3 id="remove-answers">Remove answers</h3>
<p>While clicking on the remove button the selected item needs to be deleted.
In the OnSelect the following logic is added:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>Remove(
</span></span><span style="display:flex;"><span>    colTabularAnswers,
</span></span><span style="display:flex;"><span>    LookUp(colTabularAnswers, ID = galTabular.Selected.ID)
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>UpdateIf(
</span></span><span style="display:flex;"><span>    colQuestionsModified, QuestionID = ThisItem.QuestionID,
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        Modified: 1,
</span></span><span style="display:flex;"><span>        Answer: Text(JSON(Filter(colTabularAnswers As data, data.QuestionID = ThisRecord.QuestionID)))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>Both the collection of tabular answers and the collection which stores the values of the modified questions is updated.</p>
<h3 id="pre-load-previous-answers">Pre-load previous answers</h3>
<p>All the above steps are required for newly answered tabular questions. Additionally, previous answers need to be loaded into the dynamic form. When selecting a previously filled-in form, the colQuestions collection is loaded to store all the information regarding the questions and given answers. For tabular questions, this means the answer values are loaded as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;Column1&#34;</span>:<span style="color:#f1fa8c">&#34;Training/Certification&#34;</span>,<span style="color:#ff79c6">&#34;Column2&#34;</span>:<span style="color:#f1fa8c">&#34; Institution&#34;</span>,<span style="color:#ff79c6">&#34;Column3&#34;</span>:<span style="color:#f1fa8c">&#34; Year completed&#34;</span>,<span style="color:#ff79c6">&#34;Column4&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;Column5&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;ColumnType&#34;</span>:<span style="color:#bd93f9">0</span>,<span style="color:#ff79c6">&#34;ID&#34;</span>:<span style="color:#f1fa8c">&#34;4d658e27-a765-4179-af59-b6883fd1c7a0&#34;</span>,<span style="color:#ff79c6">&#34;QuestionID&#34;</span>:<span style="color:#f1fa8c">&#34;58935396-891d-ef11-840a-002248a269cd&#34;</span>},
</span></span><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;Column1&#34;</span>:<span style="color:#f1fa8c">&#34;Scrum master&#34;</span>,<span style="color:#ff79c6">&#34;Column2&#34;</span>:<span style="color:#f1fa8c">&#34;Scrum.org&#34;</span>,<span style="color:#ff79c6">&#34;Column3&#34;</span>:<span style="color:#f1fa8c">&#34;2022&#34;</span>,<span style="color:#ff79c6">&#34;Column4&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;Column5&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;ColumnType&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#ff79c6">&#34;ID&#34;</span>:<span style="color:#f1fa8c">&#34;22d3907e-f7ca-4cfa-af4c-3316e2888788&#34;</span>,<span style="color:#ff79c6">&#34;QuestionID&#34;</span>:<span style="color:#f1fa8c">&#34;58935396-891d-ef11-840a-002248a269cd&#34;</span>},
</span></span><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;Column1&#34;</span>:<span style="color:#f1fa8c">&#34;PL-100&#34;</span>,<span style="color:#ff79c6">&#34;Column2&#34;</span>:<span style="color:#f1fa8c">&#34;Microsoft&#34;</span>,<span style="color:#ff79c6">&#34;Column3&#34;</span>:<span style="color:#f1fa8c">&#34;2023&#34;</span>,<span style="color:#ff79c6">&#34;Column4&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;Column5&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;ColumnType&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#ff79c6">&#34;ID&#34;</span>:<span style="color:#f1fa8c">&#34;0138e7c9-6e85-4e35-9cd7-0f85bd38c438&#34;</span>,<span style="color:#ff79c6">&#34;QuestionID&#34;</span>:<span style="color:#f1fa8c">&#34;58935396-891d-ef11-840a-002248a269cd&#34;</span>},
</span></span><span style="display:flex;"><span>{<span style="color:#ff79c6">&#34;Column1&#34;</span>:<span style="color:#f1fa8c">&#34;PL-200&#34;</span>,<span style="color:#ff79c6">&#34;Column2&#34;</span>:<span style="color:#f1fa8c">&#34;Microsoft&#34;</span>,<span style="color:#ff79c6">&#34;Column3&#34;</span>:<span style="color:#f1fa8c">&#34;2024&#34;</span>,<span style="color:#ff79c6">&#34;Column4&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;Column5&#34;</span>:<span style="color:#f1fa8c">&#34; &#34;</span>,<span style="color:#ff79c6">&#34;ColumnType&#34;</span>:<span style="color:#bd93f9">1</span>,<span style="color:#ff79c6">&#34;ID&#34;</span>:<span style="color:#f1fa8c">&#34;34aa3e5c-188a-4914-991f-71801b5ff97f&#34;</span>,<span style="color:#ff79c6">&#34;QuestionID&#34;</span>:<span style="color:#f1fa8c">&#34;58935396-891d-ef11-840a-002248a269cd&#34;</span>}
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>This needs to be transformed into rows in the colTabularAnswers.
This can be done using following PowerFx:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>ForAll(
</span></span><span style="display:flex;"><span>    Filter(colQuestions,FieldType = <span style="color:#f1fa8c">&#34;Tabular&#34;</span>) As data,
</span></span><span style="display:flex;"><span>            ForAll(
</span></span><span style="display:flex;"><span>                ParseJSON(data.Answer) As jsondata, 
</span></span><span style="display:flex;"><span>                If(
</span></span><span style="display:flex;"><span>                    Int(jsondata.ColumnType) = <span style="color:#bd93f9">1</span>,
</span></span><span style="display:flex;"><span>                    Collect(
</span></span><span style="display:flex;"><span>                        colTabularAnswers,
</span></span><span style="display:flex;"><span>                        {
</span></span><span style="display:flex;"><span>                            Column1: Text(jsondata.Column1),
</span></span><span style="display:flex;"><span>                            Column2: Text(jsondata.Column2),
</span></span><span style="display:flex;"><span>                            Column3: Text(jsondata.Column3),
</span></span><span style="display:flex;"><span>                            Column4: Text(jsondata.Column4),
</span></span><span style="display:flex;"><span>                            Column5: Text(jsondata.Column5),
</span></span><span style="display:flex;"><span>                            QuestionID: GUID(jsondata.QuestionID),
</span></span><span style="display:flex;"><span>                            ID: GUID(),
</span></span><span style="display:flex;"><span>                            ColumnType: Int(jsondata.ColumnType)
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                    )
</span></span><span style="display:flex;"><span>                )
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>        );
</span></span></code></pre></div><h2 id="patch">Patch</h2>
<p>On a separate save button all the given answers are patched to the Dataverse table.</p>
<p>Hopefully Microsoft comes with a solution to have the ability to create and use flexible column names. Unto that moment this can be a way to go.</p>
<h2 id="tips-and-tricks">Tips and tricks</h2>
<ul>
<li>The height of the background is set dynamically. This is done based on the number of rows added as tabular answers. In the gallery in which all the questions types are stored a button is added in which the height is set based on the current fieldtype.</li>
</ul>
<pre tabindex="0"><code>  If(ThisItem.FieldType = &#34;Tabular&#34;,
    (CountRows(MatchAll(ThisItem.Description,&#34;\n&#34;)) +1 ) * 20 + (CountRows(Filter(colTabularAnswers, QuestionID = ThisItem.QuestionID And ColumnType = 1)) * 41) + conTabularHeader.Height + conTabularForm.Height + 50, 40)
</code></pre><p><img src="/images/20240605DynamicFormsTabular/8-nested.png" alt="nested"></p>

  </article>

  
<div class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'burgersandbytes';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



  
  
</div>

<div style="background: #92400E;">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
    <div>
      <div class="text-3xl font-bold mb-2">Empowering productivity - one blog at a time!</div>
      <p class="opacity-60"></p>
    </div>

    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2">
      

      
      <li>
        <a href="https://twitter.com/elianne_tweets" target="_blank" rel="noopener" aria-label="Twitter"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1668.56 1221.19" width="24" height="24"
            stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M283.94,167.31l386.39,516.64L281.5,1104h87.51l340.42-367.76L984.48,1104h297.8L874.15,558.3l361.92-390.99
  h-87.51l-313.51,338.7l-253.31-338.7H283.94z M412.63,231.77h136.81l604.13,807.76h-136.81L412.63,231.77z" />

          </svg>
        </a>
      </li>
      

      

      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a href="https://nl.linkedin.com/in/elianne-b-48946864" target="_blank" rel="noopener" aria-label="LinkedIn"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      


      
      <li>
        <a href="https://www.burgersandbytes.nl/index.xml" target="_blank" rel="noopener" aria-label="rss"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="-125 -100 712 712" width="24" height="24"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
  <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/>
<path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/>
<path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/>
        </svg>

        


        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright ¬© 2025 - Elianne Burgers ¬∑ All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none"  stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12"  />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="//aseURL:1313/js/scripts.min.js"></script>


  







<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
