<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=65249&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="http://www.burgersandbytes.nl" rel="canonical" />

  <link rel="icon" href="favicon.png">

  <title>
  Power Apps Canvas: filter data of related entity - Burgers &amp; Bytes
  </title>
  <meta name="description" content="Filter gallery with values from related entity" /><meta name="generator" content="Hugo 0.128.2">
  <link rel="stylesheet" href="/css/styles.css" />
  
  

  <meta property="og:title" content="Power Apps Canvas: filter data of related entity" />
<meta property="og:description" content="Filter gallery with values from related entity" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//aseURL:65249/blog/20240306filterrelatedentity/" /><meta property="og:image" content="//aseURL:65249/00FilterRelatedEntity.png" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2024-03-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-06T00:00:00+00:00" />


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//aseURL:65249/00FilterRelatedEntity.png">
  <meta name="twitter:title" content="Power Apps Canvas: filter data of related entity">
  <meta name="twitter:description" content="Filter gallery with values from related entity">

  
  <meta itemprop="name" content="Power Apps Canvas: filter data of related entity">
  <meta itemprop="description" content="Filter gallery with values from related entity">
  <meta itemprop="datePublished" content="2024-03-06T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-03-06T00:00:00+00:00">
  <meta itemprop="wordCount" content="446">
  <meta itemprop="image" content="//aseURL:65249/00FilterRelatedEntity.png">
  <meta itemprop="keywords" content="Power Apps,Filter,With Function,Related Entities">

 

  

  
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="//aseURL:65249/" class="capitalize font-extrabold text-2xl">
    
    <img src="/logo.png" alt="Burgers &amp; Bytes" class="max-w-full" style="height:75px" />
    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">

    
    <li><a href="/">Home</a></li>
    
    <li><a href="/blog/">Blog</a></li>
    
    <li><a href="/page/about/">About</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
  </ul>
</header>
<main class="flex-1">
  
  

  
  
    <div class="relative max-w-xl mx-auto px-4">
    <img src="/images/20240306FilterRelatedEntity/00FilterRelatedEntity.png" class="rounded-lg shadow-sm w-full object-contain" />
    
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      
  
    March 6, 2024
  


    </div>
    
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Power Apps Canvas: filter data of related entity</h1>
    
    <h5 class="text-sm flex items-center flex-wrap">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Mar 6, 2024 
      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      3&nbsp;
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      446&nbsp;
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4">
        

        
        <li>
        <a href="#scenario">Scenario</a>
        

        
        <ul>
            <li>
        <a href="#database-model">Database model</a>
        

        
        </li></ul>
      </li><li>
        <a href="#end-result">End result</a>
        

        
        </li><li>
        <a href="#create-filters-of-comboboxes">Create filters of comboboxes</a>
        

        
        </li><li>
        <a href="#formula-in-the-gallery-items-using-with">Formula in the gallery items using With</a>
        

        
        </li><li>
        <a href="#tips-and-tricks">Tips and tricks</a>
        </li></ul>
  </details>

    <h2 id="scenario">Scenario</h2>
<p>In the following scenario there is reservation system of different type of housing. For all housings there is an apartment type registered, which are stored in a different table.
In the overview of the reservation you want to be able to filter on apartment type and related capacity.</p>
<p><img src="/images/20240306FilterRelatedEntity/1-ScreenOverview.png" alt="Screen overview"></p>
<p>This blog describes how to filter a gallery based on values from related entities.</p>
<h3 id="database-model">Database model</h3>
<p>To get a proper insight of the data structure, the database architecture looks like this:</p>
<p><img src="/images/20240306FilterRelatedEntity/2-DatabaseTables.png" alt="Database Tables"></p>
<p>The challenge is to filter the ApartmentReservations based on the values from ApartmentTypes for which there is no direct relation to those two tables.</p>
<p><img src="/images/20240306FilterRelatedEntity/2a-DatabaseTablesFilter.png" alt="Database Tables"></p>
<details>
<summary>Tables</summary>
The example content of the tables in Dataverse
<p>ApartmentType
<img src="/images/20240306FilterRelatedEntity/3-TableApartmentType.png" alt="Database Tables"></p>
<p>Apartment
<img src="/images/20240306FilterRelatedEntity/4-TableApartment.png" alt="Database Tables"></p>
<p>ApartmentReservations
<img src="/images/20240306FilterRelatedEntity/5-TableApartmentReservation.png" alt="Database Tables"></p>
</details>
<h2 id="end-result">End result</h2>
<p>In the end result the user is able to filter on both type and capacity.
If there is no housing available of chosen type and capacity, the gallery needs to be empty.</p>
<p><img src="/images/20240306FilterRelatedEntity/6-EndresultFilterRelatedEntity.gif" alt="Filter Endresult"></p>
<h2 id="create-filters-of-comboboxes">Create filters of comboboxes</h2>
<p>The filters are created using combobox and Item values as choice options.
<img src="/images/20240306FilterRelatedEntity/7-Filter.png" alt="Filter Endresult"></p>
<h2 id="formula-in-the-gallery-items-using-with">Formula in the gallery items using With</h2>
<p>The gallery shows the relevant data.
The columns Type and Capacity have specific formula to show the data, due to the fact the information comes from the ApartmentTypes table and not the ApartmentReservation table of which the data is shown primarily.</p>
<pre tabindex="0"><code>LookUp(Apartments, Name = ThisItem.Apartment.Name).ApartmentType.Type
</code></pre><p><img src="/images/20240306FilterRelatedEntity/8-Lookup.png" alt="Lookup formula"></p>
<p>The Items property of the gallery contains the formula so the shown items are in line with the chosen filters.</p>
<p><img src="/images/20240306FilterRelatedEntity/9-GalleryItems.png" alt="Gallery Items"></p>
<pre tabindex="0"><code>With({ApartmentTypes: 
        Filter(ApartmentTypes, 
        (cmbFilterCapacity.Selected.Value = Blank() Or Capacity = cmbFilterCapacity.Selected.Value),
        (cmbFilterType.Selected.Value = Blank() Or Type = cmbFilterType.Selected.Value)).ApartmentType
    },
    If(CountRows(ApartmentTypes) &gt; 0,
    With({Apartments: Filter(Apartments,
                ApartmentType.ApartmentType in ApartmentTypes).Apartment
        },
       With({Reservations: Filter(
                    ApartmentReservations,
                    Apartment.Apartment in Apartments                   
                    )
            },
            Sort(
                Reservations,
                Apartment.Name,
                SortOrder.Ascending
            )
        )
    )
)
)
</code></pre><p>Explanation of the steps in the formula:</p>
<ol>
<li>Filter the ApartmentType table with the values from the Type and/or Capacity combobox and store the outcome in the local variable using the With.</li>
<li>The check <kbd>If(CountRows(ApartmentTypes) &gt; 0</kbd> is added so if the outcome of doesn&rsquo;t give back any result, the rest of the function doesn&rsquo;t need to be performed.</li>
<li>Based on this variable the Apartment table can be filtered with relevant Apartments who have to correct ApartmentTypes</li>
<li>Next step is to finally filter the ApartmentReservation table based on the outcome of the filtered Apartments.</li>
<li>Last step is to properly sort the items of the reservations, in this case sorted ascending on the name of the apartment.</li>
</ol>
<p>Advantages of using the With formula is to improve the readability of this large formula, so the steps are easy to read and the process of the data can be followed.</p>
<h2 id="tips-and-tricks">Tips and tricks</h2>
<ul>
<li>Create database architectural overviews easily using: <a href="https://dbdiagram.io/d" target="_blank" rel="noopener">https://dbdiagram.io/d</a>
</li>
<li><a href="https://learn.microsoft.com/en-us/power-platform/power-fx/reference/function-with" target="_blank" rel="noopener">Official explanation of the With function in Power Apps</a>
</li>
</ul>

  </article>

  
<div class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'burgersandbytes';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



  
  
</div>

<div style="background: #92400E;">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
    <div>
      <div class="text-3xl font-bold mb-2">Empowering productivity - one blog at a time!</div>
      <p class="opacity-60"></p>
    </div>

    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2">
      

      
      <li>
        <a href="https://twitter.com/elianne_tweets" target="_blank" rel="noopener" aria-label="Twitter"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1668.56 1221.19" width="24" height="24"
            stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M283.94,167.31l386.39,516.64L281.5,1104h87.51l340.42-367.76L984.48,1104h297.8L874.15,558.3l361.92-390.99
  h-87.51l-313.51,338.7l-253.31-338.7H283.94z M412.63,231.77h136.81l604.13,807.76h-136.81L412.63,231.77z" />

          </svg>
        </a>
      </li>
      

      

      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a href="https://nl.linkedin.com/in/elianne-b-48946864" target="_blank" rel="noopener" aria-label="LinkedIn"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      


      
      <li>
        <a href="https://www.burgersandbytes.nl/index.xml" target="_blank" rel="noopener" aria-label="rss"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="-125 -100 712 712" width="24" height="24"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
  <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/>
<path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/>
<path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/>
        </svg>

        


        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright © 2024 - Elianne Burgers · All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12"  />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="//aseURL:65249/js/scripts.min.js"></script>


  







<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
