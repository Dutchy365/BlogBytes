<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="http://www.burgersandbytes.nl" rel="canonical" />

  <link rel="icon" href="favicon.png">

  <title>
  Automated Dataverse low-code plugin - Burgers &amp; Bytes
  </title>
  <meta name="description" content="How using dataverse low-code plugin helped by offloading logic process resulted in a substantial performance improvement." /><meta name="generator" content="Hugo 0.128.2">
  <link rel="stylesheet" href="/css/styles.css" />
  
  

  <meta property="og:title" content="Automated Dataverse low-code plugin" />
<meta property="og:description" content="How using dataverse low-code plugin helped by offloading logic process resulted in a substantial performance improvement." />
<meta property="og:type" content="article" />
<meta property="og:url" content="//aseURL:1313/blog/20240707-dataverselowcodeplugin/" /><meta property="og:image" content="//aseURL:1313/00Dataverseplugin.png" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2024-07-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-07-07T00:00:00+00:00" />


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//aseURL:1313/00Dataverseplugin.png">
  <meta name="twitter:title" content="Automated Dataverse low-code plugin">
  <meta name="twitter:description" content="How using dataverse low-code plugin helped by offloading logic process resulted in a substantial performance improvement.">

  
  <meta itemprop="name" content="Automated Dataverse low-code plugin">
  <meta itemprop="description" content="How using dataverse low-code plugin helped by offloading logic process resulted in a substantial performance improvement.">
  <meta itemprop="datePublished" content="2024-07-07T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-07-07T00:00:00+00:00">
  <meta itemprop="wordCount" content="641">
  <meta itemprop="image" content="//aseURL:1313/00Dataverseplugin.png">
  <meta itemprop="keywords" content="Power Apps,Dataverse,Plugin">

 

  

  
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="//aseURL:1313/" class="capitalize font-extrabold text-2xl">
    
    <img src="/logo.png" alt="Burgers &amp; Bytes" class="max-w-full" style="height:75px" />
    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">

    
    <li><a href="/">Home</a></li>
    
    <li><a href="/blog/">Blog</a></li>
    
    <li><a href="/page/about/">About</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
  </ul>
</header>
<main class="flex-1">
  
  

  
  
    <div class="relative max-w-xl mx-auto px-4">
    <img src="/images/20240707Dataverseplugin/00Dataverseplugin.png" class="rounded-lg shadow-sm w-full object-contain" />
    
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      
  
    July 7, 2024
  


    </div>
    
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Automated Dataverse low-code plugin</h1>
    
    <h5 class="text-sm flex items-center flex-wrap">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Jul 7, 2024 
      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      4&nbsp;
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      641&nbsp;
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4">
        

        
        <li>
        <a href="#scenario">Scenario</a>
        

        
        </li><li>
        <a href="#end-result">End result</a>
        

        
        </li><li>
        <a href="#architecture-and-process">Architecture and process</a>
        

        
        </li><li>
        <a href="#challenge">Challenge</a>
        

        
        </li><li>
        <a href="#dataverse-plugin">Dataverse plugin</a>
        

        
        <ul>
            <li>
        <a href="#meeting-presence">Meeting presence</a>
        

        
        </li></ul>
      </li><li>
        <a href="#power-app">Power App</a>
        

        
        </li><li>
        <a href="#conclusion">Conclusion</a>
        

        
        </li><li>
        <a href="#resources">Resources</a>
        </li></ul>
  </details>

    <p>Side note: while writing this blog Dataverse low-code plugins are still in preview.</p>
<h2 id="scenario">Scenario</h2>
<p>This blog explores a real-world business scenario involving multiple meeting rooms where CO₂ levels are monitored throughout the day. These measurements indicate the presence of people in the rooms. By correlating this data with the meeting room reservations, we can infer the room occupancy.</p>
<h2 id="end-result">End result</h2>
<p>The end result is a Power App in which a calender view is available in which you can see whether a meetingroom was occupied during the meeting or not. (due to the requirement to have calender view with different colors PowerBI wasn&rsquo;t suitable)</p>
<p><img src="/images/20240707DataversePlugin/end-result.gif" alt="End result"></p>
<h2 id="architecture-and-process">Architecture and process</h2>
<p>The tables present to support this scenario:</p>
<p><img src="/images/20240707DataversePlugin/architecture.png" alt="architecture"></p>
<p>In the <em>meeting</em>  table the original meeting date and times are stored including their location.
In the <em>sensor data</em>  table the sensor data is stored.
In the <em>meetingpresence</em> table is updated by the plugin.</p>
<p>The following process is made:
<img src="/images/20240707DataversePlugin/process.png" alt="Process"></p>
<h2 id="challenge">Challenge</h2>
<p>Meeting room reservations are updated in the table on a weekly basis, with the number of rows corresponding to the number of meetings at each location.</p>
<p>Sensor data is also loaded into the sensor data table weekly, generating substantial records. Data is available every 15 minutes on workdays between 08:00 and 18:00. For instance, if a location has 40 sensor data rows per day, this translates to 200 rows per week and 800 rows per month.</p>
<p>Example data for sensor data:
<img src="/images/20240707DataversePlugin/exampledatasensor.png" alt="Example data"></p>
<h2 id="dataverse-plugin">Dataverse plugin</h2>
<p>By using the Dataverse Accelerator App you&rsquo;re able to create a plugin.
In this scenario it will be an automated one. As soon as a meeting is added into the table the plugin is fired.</p>
<p>Code to create new row in another table:</p>
<pre tabindex="0"><code>Collect(MeetingPresences, {
    Location: NewRecord.Location, 
    &#39;Start Date&#39;:NewRecord.Startdate, 
    &#39;End Date&#39;: NewRecord.Enddate, 
    Presence:If(CountRows(Filter(&#39;Sensor data&#39;,RecordedTime &gt;= NewRecord.Startdate &amp;&amp; RecordedTime &lt;= NewRecord.Enddate &amp;&amp; Location = NewRecord.Location &amp;&amp; PresenceValue = 1))&gt; 0, &#34;Yes&#34;,&#34;No&#34;)
    }
)
</code></pre><p>The formula Collect(MeetingPresences, {&hellip;}) adds a new record to the MeetingPresences table. For each new meeting, it captures the Location, Start Date, and End Date. It also checks if there is any sensor data indicating presence (PresenceValue = 1) within the meeting&rsquo;s time range (RecordedTime between Startdate and Enddate) and at the specified Location. If such data is found, the Presence field is set to &ldquo;Yes&rdquo;; otherwise, it is set to &ldquo;No&rdquo;.</p>
<h3 id="meeting-presence">Meeting presence</h3>
<p>In the meeting presence table the column Color is of type formula. Based on the presence value the color value is populated: <code>If(Presence=&quot;Yes&quot;, &quot;#299D8F&quot;, &quot;#B7353B&quot;)</code></p>
<h2 id="power-app">Power App</h2>
<p><img src="/images/20240707DataversePlugin/appelements.png" alt="App elements"></p>
<p>In the app only the records of meeting presence table are needed.
The available locations are preloaded into a collection named &lsquo;colAllLocations&rsquo;.
While selecting the location into the gallery a collection &lsquo;colSelectedLocations&rsquo; is populated.</p>
<p>On the load button the meeting presence records for selected locations are loaded into a collection names &lsquo;colCalenderEvents&rsquo;.</p>
<pre tabindex="0"><code>Clear(colCalenderEvents);

ForAll(colSelectedLocations As Spaceloop, 
        ForAll(
            Filter(
                MeetingPresences,
                Location = Spaceloop.Value 
            ),
            Collect(
                colCalenderEvents,
                {
                    Meetingid: ThisRecord.&#39;Meeting Presence&#39;,
                    Location: ThisRecord.Location, 
                    Color: ThisRecord.Color,
                    Startdate: ThisRecord.&#39;Start Date&#39;,
                    Enddate: ThisRecord.&#39;End Date&#39;
                }
            )
        ) 
);
</code></pre><p>The settings of the calendar component:
<img src="/images/20240707DataversePlugin/calendarsettings.png" alt="Calendar component">
In the Items of the calendar component the collection is set as datasource: &lsquo;colCalendarEvents&rsquo;.</p>
<p>Selecting all locations results in a populated calendar view in which meetings are visually displayed by booked and present or booked and absent.</p>
<p><img src="/images/20240707DataversePlugin/calendar.png" alt="Calendar"></p>
<h2 id="conclusion">Conclusion</h2>
<p>In the real-life business scenario, we dealt with 2,000 records across 16 locations. Knowing those amounts will grow over time. Initially, we created a collection of 16 items and performed lookups in Dataverse for each, searching for matches based on specific criteria. This approach led to poor performance and an excessively large collection that needed to handle 30.000 rows.</p>
<p>By using Dataverse automated low-code plugin, we offloaded the logic processing, reducing the number of records in the app significantly. This resulted in a substantial performance improvement.</p>
<h2 id="resources">Resources</h2>
<ul>
<li>Calendar: To create the calendar view, the PCF component <a href="https://pcf.gallery/calendar-control/" target="_blank" rel="noopener">Calendar control</a>
 is imported.</li>
<li><a href="https://learn.microsoft.com/en-us/power-apps/maker/data-platform/low-code-plug-ins?tabs=automated" target="_blank" rel="noopener">Low-code plugin on Microsoft Learn</a>
</li>
</ul>

  </article>

  
<div class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'burgersandbytes';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



  
  
</div>

<div style="background: #92400E;">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
    <div>
      <div class="text-3xl font-bold mb-2">Empowering productivity - one blog at a time!</div>
      <p class="opacity-60"></p>
    </div>

    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2">
      

      
      <li>
        <a href="https://twitter.com/elianne_tweets" target="_blank" rel="noopener" aria-label="Twitter"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1668.56 1221.19" width="24" height="24"
            stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M283.94,167.31l386.39,516.64L281.5,1104h87.51l340.42-367.76L984.48,1104h297.8L874.15,558.3l361.92-390.99
  h-87.51l-313.51,338.7l-253.31-338.7H283.94z M412.63,231.77h136.81l604.13,807.76h-136.81L412.63,231.77z" />

          </svg>
        </a>
      </li>
      

      

      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a href="https://nl.linkedin.com/in/elianne-b-48946864" target="_blank" rel="noopener" aria-label="LinkedIn"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      


      
      <li>
        <a href="https://www.burgersandbytes.nl/index.xml" target="_blank" rel="noopener" aria-label="rss"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="-125 -100 712 712" width="24" height="24"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
  <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/>
<path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/>
<path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/>
        </svg>

        


        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright © 2024 - Elianne Burgers · All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12"  />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="//aseURL:1313/js/scripts.min.js"></script>


  







<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
