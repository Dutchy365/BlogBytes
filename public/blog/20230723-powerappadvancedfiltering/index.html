<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="http://www.burgersandbytes.nl" rel="canonical" />

  <link rel="icon" href="favicon.png">

  <title>
  Power Apps: Advanced filtering on a period of time with only Month and Year value - Burgers &amp; Bytes
  </title>
  <meta name="description" content="Guide to create from to filters based on Month/ Year values only" /><meta name="generator" content="Hugo 0.128.2">
  <link rel="stylesheet" href="/css/styles.css" />
  
  

  <meta property="og:title" content="Power Apps: Advanced filtering on a period of time with only Month and Year value" />
<meta property="og:description" content="Guide to create from to filters based on Month/ Year values only" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//aseURL:1313/blog/20230723-powerappadvancedfiltering/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2023-07-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-07-22T00:00:00+00:00" />


  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Power Apps: Advanced filtering on a period of time with only Month and Year value">
  <meta name="twitter:description" content="Guide to create from to filters based on Month/ Year values only">

  
  <meta itemprop="name" content="Power Apps: Advanced filtering on a period of time with only Month and Year value">
  <meta itemprop="description" content="Guide to create from to filters based on Month/ Year values only">
  <meta itemprop="datePublished" content="2023-07-22T00:00:00+00:00">
  <meta itemprop="dateModified" content="2023-07-22T00:00:00+00:00">
  <meta itemprop="wordCount" content="634">
  <meta itemprop="keywords" content="Power Apps,Filtering Gallery,Month Year,Collection">

 

  

  
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="//aseURL:1313/" class="capitalize font-extrabold text-2xl">
    
    <img src="/logo.png" alt="Burgers &amp; Bytes" class="max-w-full" style="height:75px" />
    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">

    
    <li><a href="/">Home</a></li>
    
    <li><a href="/blog/">Blog</a></li>
    
    <li><a href="/page/about/">About</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
  </ul>
</header>
<main class="flex-1">
  
  

  
  
    <div class="relative max-w-xl mx-auto px-4">
    <img src="/images/20230723PowerAppAdvancedFiltering/00AdvancedFiltering.png" class="rounded-lg shadow-sm w-full object-contain" />
    
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      
  
    July 22, 2023
  


    </div>
    
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Power Apps: Advanced filtering on a period of time with only Month and Year value</h1>
    
    <h5 class="text-sm flex items-center flex-wrap">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Jul 22, 2023 
      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      3&nbsp;
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      634&nbsp;
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4">
        

        
        <li>
        <a href="#scenario">Scenario</a>
        

        
        </li><li>
        <a href="#end-result">End result</a>
        

        
        </li><li>
        <a href="#step-by-step">Step by step</a>
        

        
        <ul>
            <li>
        <a href="#store-data">Store data</a>
        

        
        </li><li>
        <a href="#magic-in-the-patch-formula">Magic in the Patch formula</a>
        

        
        </li><li>
        <a href="#collection-with-dynamic-month-year-values">Collection with dynamic Month Year values</a>
        

        
        </li><li>
        <a href="#comboboxes-as-filters">Comboboxes as filters</a>
        

        
        </li><li>
        <a href="#gallery-filtering">Gallery filtering</a>
        </li></ul>
    </li></ul>
  </details>

    <h2 id="scenario">Scenario</h2>
<p>Todays scenario is regarding filter options based on Month and Year values in Power Apps. In a Dataverse table named ‘Products’ the information of a Name, Month and Year are stored. The challenging part is the Month column only contains the text value of the short form of the month.</p>
<p>The data in the table looks like:</p>
<p><img src="/images/20230723PowerAppAdvancedFiltering/1-table.png" alt="table"></p>
<p>Now it needs to be possible to filter the gallery based on a Month Year range filter. There where some challenges to overcome of which the solutions are shared in this blog.</p>
<p>Solved challenges:</p>
<ul>
<li>Month value is short text value of the month, like Jan, Aug, Dec.</li>
<li>Over time there will be more years added</li>
<li>Datepicker as filter selection doesn’t meet requirements, because specific date isn’t relevant, only Month and Year</li>
</ul>
<h2 id="end-result">End result</h2>
<p>The end result looks like this:</p>
<p><img src="/images/20230723PowerAppAdvancedFiltering/2-FilterMonthYearValueGIF.gif" alt="End Result"></p>
<h2 id="step-by-step">Step by step</h2>
<p>There are some steps to take in order to get the end result you want to have.</p>
<h3 id="store-data">Store data</h3>
<p>It starts with storing the data in the Products table. The Form to enter data contains only three fields and a save button:</p>
<p><img src="/images/20230723PowerAppAdvancedFiltering/3-ExampleForm.png" alt="Example Form"></p>
<p>The Month Value is a choice column for which the values can be selected by using a ComboBox:</p>
<p><img src="/images/20230723PowerAppAdvancedFiltering/4-MonthCombobox.png" alt="Month Combobox"></p>
<p>Year is a column of type Number.</p>
<p>In the Dataverse table an extra Number column is created, named MonthYearValue. While saving records this column needs to be updated. Based on the formula: <kbd>(Year * 100 + Month numeric value)</kbd>. The user only selects a month by the ComboBox, so the calculation needs to be made while saving the record.</p>
<h3 id="magic-in-the-patch-formula">Magic in the Patch formula</h3>
<p>The magic happens in the Patch formula, by creating a Switch between the selected Month and the related number of the Month.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>Patch(
</span></span><span style="display:flex;"><span>    Products,
</span></span><span style="display:flex;"><span>    Defaults(Products),
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        Name: txtProduct.Text,
</span></span><span style="display:flex;"><span>        Month: cmbMonth.Selected.Value,
</span></span><span style="display:flex;"><span>        Year: Value(txtYear.Text),
</span></span><span style="display:flex;"><span>        MonthYearValue: Sum(
</span></span><span style="display:flex;"><span>            Value(txtYear.Text) * 100 + Switch(
</span></span><span style="display:flex;"><span>                Text(cmbMonth.Selected.Value),
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Jan&#34;</span>,1,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Feb&#34;</span>,2,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Mar&#34;</span>,3,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Apr&#34;</span>,4,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;May&#34;</span>,5,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Jun&#34;</span>,6,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Jul&#34;</span>,7,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Aug&#34;</span>,8,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Sep&#34;</span>,9,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Oct&#34;</span>,10,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Nov&#34;</span>,11,
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&#34;Dec&#34;</span>,12,
</span></span><span style="display:flex;"><span>                0
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>An example of input and what’s saved in the table. When an user enters the following in to the form and clicks on save:</p>
<p><img src="/images/20230723PowerAppAdvancedFiltering/5-ExampleFormInput.png" alt="Example Form input"></p>
<p>In the Dataverse table the column MonthYearValue is populated:</p>
<p><img src="/images/20230723PowerAppAdvancedFiltering/6-DataverseTable.png" alt="Dataverse table populated"></p>
<p>Now all items in the table have a MonthYearValue which can be used to filter on. Next step is to set up the filters.</p>
<h3 id="collection-with-dynamic-month-year-values">Collection with dynamic Month Year values</h3>
<p>There needs to be a collection which can be used in the ComboBoxes.
The collection needs to be flexible based on the unique Year values that are available in the Products table. So first step is to get Distinct values of the Years and use UpdateContext to store those values. Next step in the collection is to loop through all those years and get all months for those years. In a separate column of the collection the calculation is made to be used to filter on, again the formula: <kbd>(Year * 100 + Month numeric value)</kbd>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>UpdateContext({Years: Distinct(Products,Year)});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Clear(ColMonthYearFilter);
</span></span><span style="display:flex;"><span>ForAll(
</span></span><span style="display:flex;"><span>    Sequence(Count(Years), Min(Years,Value)) As Year,
</span></span><span style="display:flex;"><span>ForAll(
</span></span><span style="display:flex;"><span>        Sequence(<span style="color:#bd93f9">12</span>),
</span></span><span style="display:flex;"><span>        Collect(
</span></span><span style="display:flex;"><span>            ColMonthYearFilter,
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                Month: Value,
</span></span><span style="display:flex;"><span>                MonthYear: Concatenate(Last(FirstN(Calendar.MonthsShort(),Value)).Value, <span style="color:#ff79c6">&#34; &#34;</span>,
</span></span><span style="display:flex;"><span>                    Year.Value),
</span></span><span style="display:flex;"><span>                Year: Year.Value,
</span></span><span style="display:flex;"><span>                Calculation: Sum((Year.Value * 100) + Value)
</span></span><span style="display:flex;"><span>            }       
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>));
</span></span></code></pre></div><p>The content of the collection:</p>
<p><img src="/images/20230723PowerAppAdvancedFiltering/7-CollectionContent.png" alt="Content of Collection"></p>
<h3 id="comboboxes-as-filters">Comboboxes as filters</h3>
<p>Create two ComboBoxes and set Items to the name of the collection, in this example ‘ColMonthYearFilter’. One ComboBox to use for the Month From and one for Month To.</p>
<p><img src="/images/20230723PowerAppAdvancedFiltering/8-FilterComboboxes.png" alt="Filter Comboboxes"></p>
<h3 id="gallery-filtering">Gallery filtering</h3>
<p>In the Gallery you need to setup the filter for the items. In this scenario all the items needs to be shown when no filter is active and when filters are set the gallery needs to display the filtered items.
In Items of the gallery the following formula is used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>Sort(
</span></span><span style="display:flex;"><span>    Filter(
</span></span><span style="display:flex;"><span>        Products,
</span></span><span style="display:flex;"><span>        (cmbMonthFrom.Selected.Calculation = Blank() Or cmbMonthTo.Selected.Calculation = Blank()) 
</span></span><span style="display:flex;"><span>        Or (MonthYearValue &gt;= cmbMonthFrom.Selected.Calculation And MonthYearValue &lt;= cmbMonthTo.Selected.Calculation)
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    MonthYearValue
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>And now the users is able to filter the gallery on Month/Year values!</p>

  </article>

  
<div class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'burgersandbytes';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



  
  
</div>

<div style="background: #92400E;">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
    <div>
      <div class="text-3xl font-bold mb-2">Empowering productivity - one blog at a time!</div>
      <p class="opacity-60"></p>
    </div>

    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2">
      

      
      <li>
        <a href="https://twitter.com/elianne_tweets" target="_blank" rel="noopener" aria-label="Twitter"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1668.56 1221.19" width="24" height="24"
            stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M283.94,167.31l386.39,516.64L281.5,1104h87.51l340.42-367.76L984.48,1104h297.8L874.15,558.3l361.92-390.99
  h-87.51l-313.51,338.7l-253.31-338.7H283.94z M412.63,231.77h136.81l604.13,807.76h-136.81L412.63,231.77z" />

          </svg>
        </a>
      </li>
      

      

      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a href="https://nl.linkedin.com/in/elianne-b-48946864" target="_blank" rel="noopener" aria-label="LinkedIn"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      


      
      <li>
        <a href="https://www.burgersandbytes.nl/index.xml" target="_blank" rel="noopener" aria-label="rss"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="-125 -100 712 712" width="24" height="24"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
  <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/>
<path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/>
<path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/>
        </svg>

        


        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright © 2024 - Elianne Burgers · All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12"  />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="//aseURL:1313/js/scripts.min.js"></script>


  







<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
