<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="http://www.burgersandbytes.nl" rel="canonical" />

  <link rel="icon" href="favicon.png">

  <title>
  Using Microsoft Graph and Power Automate to post an Announcement Message in Teams channel - Burgers &amp; Bytes
  </title>
  <meta name="description" content="Use Invoke an HTTP request in Power Automate to POST a message" /><meta name="generator" content="Hugo 0.128.2">
  <link rel="stylesheet" href="/css/styles.css" />
  
  

  <meta property="og:title" content="Using Microsoft Graph and Power Automate to post an Announcement Message in Teams channel" />
<meta property="og:description" content="Use Invoke an HTTP request in Power Automate to POST a message" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//aseURL:1313/blog/20240212teamsannouncementmessage/" /><meta property="og:image" content="//aseURL:1313/00Announcement.png" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2024-02-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-02-12T00:00:00+00:00" />


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//aseURL:1313/00Announcement.png">
  <meta name="twitter:title" content="Using Microsoft Graph and Power Automate to post an Announcement Message in Teams channel">
  <meta name="twitter:description" content="Use Invoke an HTTP request in Power Automate to POST a message">

  
  <meta itemprop="name" content="Using Microsoft Graph and Power Automate to post an Announcement Message in Teams channel">
  <meta itemprop="description" content="Use Invoke an HTTP request in Power Automate to POST a message">
  <meta itemprop="datePublished" content="2024-02-12T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-02-12T00:00:00+00:00">
  <meta itemprop="wordCount" content="440">
  <meta itemprop="image" content="//aseURL:1313/00Announcement.png">
  <meta itemprop="keywords" content="Power Automate,Teams Provisioning,Chat Message,Announcement">

 

  

  
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="//aseURL:1313/" class="capitalize font-extrabold text-2xl">
    
    <img src="/logo.png" alt="Burgers &amp; Bytes" class="max-w-full" style="height:75px" />
    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">

    
    <li><a href="/">Home</a></li>
    
    <li><a href="/blog/">Blog</a></li>
    
    <li><a href="/page/about/">About</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
  </ul>
</header>
<main class="flex-1">
  
  

  
  
    <div class="relative max-w-xl mx-auto px-4">
    <img src="/images/20240212TeamsAnnouncementMessage/00Announcement.png" class="rounded-lg shadow-sm w-full object-contain" />
    
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      
  
    February 12, 2024
  


    </div>
    
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Using Microsoft Graph and Power Automate to post an Announcement Message in Teams channel</h1>
    
    <h5 class="text-sm flex items-center flex-wrap">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Feb 12, 2024 
      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      3&nbsp;
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      440&nbsp;
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4">
        

        
        <li>
        <a href="#scenario">Scenario</a>
        

        
        </li><li>
        <a href="#flow-actions-to-create-team">Flow actions to create Team</a>
        

        
        </li><li>
        <a href="#invoke-an-http-request">Invoke an HTTP Request</a>
        

        
        </li><li>
        <a href="#delegated-or-application-only-permissions">Delegated or application only permissions</a>
        </li></ul>
  </details>

    <h2 id="scenario">Scenario</h2>
<p>This blog describes the Flow to create a Team and start with a message of type Announcement.
The default &lsquo;Post a message in a chat or channel&rsquo; isn&rsquo;t sufficient, because the message type can&rsquo;t be selected, so it can&rsquo;t be an Announcement.</p>
<p>The end result should be a clear message in a Teams channel:
<img src="/images/20240212TeamsAnnouncementMessage/1-Announcementbanner.png" alt="Announcement"></p>
<h2 id="flow-actions-to-create-team">Flow actions to create Team</h2>
<p>In order to share the full story the Team needs to be created and Team ID and Channel ID needs to be stored in a variable.
To read the details collapse these steps below:</p>
<details>
<summary>Full Flow steps</summary>
<p>The Team is created using these steps:
The &lsquo;initialize var Teamname&rsquo; and &lsquo;Initialize var ChannelID&rsquo; are variables of type string.
<img src="/images/20240212TeamsAnnouncementMessage/2a-FlowCreateTeam.png" alt="Create Team">
<img src="/images/20240212TeamsAnnouncementMessage/2b-FlowCreateTeam.png" alt="Create Team">
Get the ID of the newly created team.
<img src="/images/20240212TeamsAnnouncementMessage/2c-FlowCreateTeam.png" alt="Create Team"></p>
<p>Get the ChannelID of the General channel and store that in the variable.</p>
<p><img src="/images/20240212TeamsAnnouncementMessage/3a-FlowChannelID.png" alt="ChannelID">
<img src="/images/20240212TeamsAnnouncementMessage/3b-FlowChannelID.png" alt="ChannelID"></p>
<p>Add a member to the newly create team.
<img src="/images/20240212TeamsAnnouncementMessage/4a-FlowAddMember.png" alt="Add member"></p>
<p>As a preparation for the content of the message the list of members is set up in HTML format.</p>
<p><img src="/images/20240212TeamsAnnouncementMessage/5a-FlowMembersList.png" alt="MembersList"></p>
</details>
<h2 id="invoke-an-http-request">Invoke an HTTP Request</h2>
<p>To post the announcement message add the action Invoke an HTTP Request.
For both the Base Resource URL and Entra ID Resource URI you can enter: <a href="https://graph.microsoft.com" target="_blank" rel="noopener">https://graph.microsoft.com</a>
</p>
<p><img src="/images/20240212TeamsAnnouncementMessage/7a-AuthenticationGraph.png" alt="Graph authentication"></p>
<p>The Url of the request is, for which team-id and channel-id are replaced for the corresponding variables:</p>
<p><code>https://graph.microsoft.com/v1.0/teams/team-id/channels/channel-id/messages</code></p>
<p>The &lsquo;Invoke an HTTP Request&rsquo;:
<img src="/images/20240212TeamsAnnouncementMessage/8a-InvokeHTTPRequest.png" alt="Invoke HTTP Request"></p>
<p>The body of the request contains all the information needed for the message to set up correctly.
The body content of the message is in HTML format, so you can use your own creativity. In this example a hyperlink to a manual and a list of added members is configured.</p>
<p>For both the body content and attachments id the same GUID needs to be set. Therefor use a variable with expression <code>guid()</code>, so both locations have the same GUID.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;subject&#34;</span>: <span style="color:#f1fa8c">&#34;Team for @{variables(&#39;Teamname&#39;)}&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;body&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;contentType&#34;</span>: <span style="color:#f1fa8c">&#34;html&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&#34;content&#34;</span>: <span style="color:#f1fa8c">&#34;&lt;attachment id=\&#34;@{variables(&#39;GUID&#39;)}\&#34;&gt;&lt;/attachment&gt;Welcome in this team. &lt;br&gt;&lt;br&gt;You have access to the planner, files and OneNote.&lt;br&gt;&lt;br&gt;The user manual can be found&lt;a href=&#39;link&#39;&gt; here&lt;/a&gt;. &lt;br&gt;&lt;br&gt;  The following users were added when the project was created:&lt;br&gt; &lt;ul&gt;@{variables(&#39;MembersList&#39;)}&lt;/ul&gt;&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&#34;attachments&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;@{variables(&#39;GUID&#39;)}&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;contentType&#34;</span>: <span style="color:#f1fa8c">&#34;application/vnd.microsoft.teams.messaging-announcementBanner&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;contentUrl&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;content&#34;</span>: <span style="color:#f1fa8c">&#34;{\&#34;title\&#34;:\&#34;This is an Announcement\&#34;,\&#34;cardImageType\&#34;:\&#34;colorTheme\&#34;,\&#34;cardImageDetails\&#34;:{\&#34;colorTheme\&#34;:\&#34;mulberryred\&#34;}}&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;thumbnailUrl&#34;</span>: <span style="color:#ff79c6">null</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&#34;teamsAppId&#34;</span>: <span style="color:#ff79c6">null</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In the attachments&gt;content the colorTheme can be defined.
<img src="/images/20240212TeamsAnnouncementMessage/9-colorTheme.png" alt="colorTheme"></p>
<p>Color names you can choose from:</p>
<ul>
<li><span style="color:rgb(205, 218, 234);font-weight:bold;">Periwinkle blue</span></li>
<li><span style="color:rgb(214, 212, 232);font-weight:bold;">Lavender</span></li>
<li><span style="color:rgb(245, 211, 223);font-weight:bold;">Rose</span></li>
<li><span style="color:rgb(251, 222, 215);font-weight:bold;">Orange sherbet</span></li>
<li><span style="color:rgb(248, 234, 205);font-weight:bold;">Flax yellow</span></li>
<li><span style="color:rgb(214, 227, 231);font-weight:bold;">Teal</span></li>
<li><span style="color:rgb(15, 48, 87);font-weight:bold;">Navy blue</span></li>
<li><span style="color:rgb(39, 33, 84);font-weight:bold;">Indigo</span></li>
<li><span style="color:rgb(117, 30, 60);font-weight:bold;">Mulberry red</span></li>
<li><span style="color:rgb(205, 89, 55);font-weight:bold;">Fire orange</span></li>
<li><span style="color:rgb(124, 88, 17);font-weight:bold;">Raw umber</span></li>
<li><span style="color:rgb(51, 105, 107); font-weight:bold;">Ocean green</span></li>
</ul>
<h2 id="delegated-or-application-only-permissions">Delegated or application only permissions</h2>
<p>Unfortunately at this moment you can&rsquo;t use application-only permissions to achieve this. Following <a href="https://learn.microsoft.com/en-us/microsoftteams/platform/graph-api/import-messages/import-external-messages-to-teams" target="_blank" rel="noopener">the documentation</a>
 you should be apply to Post a message while creating a Team in migration mode. Currently the Announcement type is out-of-scope.</p>

  </article>

  
<div class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'burgersandbytes';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



  
  
</div>

<div style="background: #92400E;">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
    <div>
      <div class="text-3xl font-bold mb-2">Empowering productivity - one blog at a time!</div>
      <p class="opacity-60"></p>
    </div>

    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2">
      

      
      <li>
        <a href="https://twitter.com/elianne_tweets" target="_blank" rel="noopener" aria-label="Twitter"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1668.56 1221.19" width="24" height="24"
            stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M283.94,167.31l386.39,516.64L281.5,1104h87.51l340.42-367.76L984.48,1104h297.8L874.15,558.3l361.92-390.99
  h-87.51l-313.51,338.7l-253.31-338.7H283.94z M412.63,231.77h136.81l604.13,807.76h-136.81L412.63,231.77z" />

          </svg>
        </a>
      </li>
      

      

      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a href="https://nl.linkedin.com/in/elianne-b-48946864" target="_blank" rel="noopener" aria-label="LinkedIn"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      


      
      <li>
        <a href="https://www.burgersandbytes.nl/index.xml" target="_blank" rel="noopener" aria-label="rss"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="-125 -100 712 712" width="24" height="24"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
  <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/>
<path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/>
<path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/>
        </svg>

        


        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright © 2024 - Elianne Burgers · All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none"  stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12"  />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="//aseURL:1313/js/scripts.min.js"></script>


  







<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
