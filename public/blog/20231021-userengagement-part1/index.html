<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="http://www.burgersandbytes.nl" rel="canonical" />

  <link rel="icon" href="favicon.png">

  <title>
  Part 1: Enhancing User Engagement Measurement on SharePoint Intranets with Power Platform - Burgers &amp; Bytes
  </title>
  <meta name="description" content="Data from user interaction: get likes and comments of news items" /><meta name="generator" content="Hugo 0.128.2">
  <link rel="stylesheet" href="/css/styles.css" />
  
  

  <meta property="og:title" content="Part 1: Enhancing User Engagement Measurement on SharePoint Intranets with Power Platform" />
<meta property="og:description" content="Data from user interaction: get likes and comments of news items" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//aseURL:1313/blog/20231021-userengagement-part1/" /><meta property="og:image" content="//aseURL:1313/00Part1.png" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2023-10-21T00:00:01+00:00" />
<meta property="article:modified_time" content="2023-10-21T00:00:01+00:00" />


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//aseURL:1313/00Part1.png">
  <meta name="twitter:title" content="Part 1: Enhancing User Engagement Measurement on SharePoint Intranets with Power Platform">
  <meta name="twitter:description" content="Data from user interaction: get likes and comments of news items">

  
  <meta itemprop="name" content="Part 1: Enhancing User Engagement Measurement on SharePoint Intranets with Power Platform">
  <meta itemprop="description" content="Data from user interaction: get likes and comments of news items">
  <meta itemprop="datePublished" content="2023-10-21T00:00:01+00:00">
  <meta itemprop="dateModified" content="2023-10-21T00:00:01+00:00">
  <meta itemprop="wordCount" content="464">
  <meta itemprop="image" content="//aseURL:1313/00Part1.png">
  <meta itemprop="keywords" content="Power Automate,User Engagement,SharePoint,Power BI">

 

  

  
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="//aseURL:1313/" class="capitalize font-extrabold text-2xl">
    
    <img src="/logo.png" alt="Burgers &amp; Bytes" class="max-w-full" style="height:75px" />
    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">

    
    <li><a href="/">Home</a></li>
    
    <li><a href="/blog/">Blog</a></li>
    
    <li><a href="/page/about/">About</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
  </ul>
</header>
<main class="flex-1">
  
  

  
  
    <div class="relative max-w-xl mx-auto px-4">
    <img src="/images/20231021UserEngagement/Part1/00Part1.png" class="rounded-lg shadow-sm w-full object-contain" />
    
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      
  
    October 21, 2023
  


    </div>
    
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Part 1: Enhancing User Engagement Measurement on SharePoint Intranets with Power Platform</h1>
    
    <h5 class="text-sm flex items-center flex-wrap">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Oct 21, 2023 
      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      3&nbsp;
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      464&nbsp;
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4">
        

        
        <li>
        <a href="#step-by-step">Step by step</a>
        

        
        <ul>
            <li>
        <a href="#trigger">Trigger</a>
        

        
        </li><li>
        <a href="#initialize-variables">Initialize variables</a>
        

        
        </li><li>
        <a href="#http-request-to-sharepoint">HTTP request to SharePoint</a>
        

        
        </li><li>
        <a href="#apply-to-each-newsitem">Apply to each newsitem</a>
        

        
        </li><li>
        <a href="#store-values-in-sharepoint-list">Store values in SharePoint list</a>
        </li></ul>
    </li></ul>
  </details>

    <p>Measuring user engagement is crucial for any SharePoint-based intranet to ensure that the platform is meeting its intended purpose and delivering value to the users. You can already benefit from Viva Connections and Viva Insights to enhance the user engagement measurement capabilities.</p>
<p>In the first part of this blog serie, we will explore how to use the Power Platform to measure user engagement even more deeply using KPI&rsquo;s regarding user engagement.</p>
<p><a href="/blog/20231021-userengagement-part2">Part 2</a>
 of this blog serie will cover the KPI regarding page freshness.</p>
<p><a href="/blog//20231021-userengagement-part3">Part 3</a>
 will cover how to visualize the collected data in Power BI to gain insights into user behavior and engagement patterns. We will walk through the creation of a dashboard that displays the engagement metrics in a clear and concise manner, allowing intranet administrators to quickly assess the intranet&rsquo;s effectiveness and identify areas for improvement.</p>
<h2 id="step-by-step">Step by step</h2>
<h3 id="trigger">Trigger</h3>
<p>Create a flow which is triggered by once per 6 months, so half yearly calculations can be made.</p>
<p><img src="/images/20231021UserEngagement/Part1/1-recurrence.png" alt="Flow trigger"></p>
<h3 id="initialize-variables">Initialize variables</h3>
<p>Initialize variables URL, varYear, varHalfYear and set the half year value dynamically.</p>
<p><img src="/images/20231021UserEngagement/Part1/2-halfyear.png" alt="Half year"></p>
<p>The date of the past half year can be detracted by using this expression:</p>
<pre tabindex="0"><code>subtractFromTime(formatDateTime(convertFromUtc(utcNow(),&#39;W. Europe Standard Time&#39;),&#39;yyyy-MM-ddTHH:mm&#39;),182, &#39;Day&#39;,&#39;yyyy-MM-ddThh:MM&#39;)
</code></pre><p><img src="/images/20231021UserEngagement/Part1/3-pasthalfyear.png" alt="Past half year"></p>
<p>Initialize all those variables as integer:</p>
<ul>
<li>NewsArticlesTotalLikes</li>
<li>NewsArticlesTotalComments</li>
<li>NewsArticleNoComments</li>
<li>NewsArticleNoLike</li>
<li>NewsArticleWithComments</li>
<li>NewsArticleWithLike</li>
</ul>
<p><img src="/images/20231021UserEngagement/Part1/4-variables.png" alt="Initialize variables"></p>
<h3 id="http-request-to-sharepoint">HTTP request to SharePoint</h3>
<p>Send an HTTP to SharePoint using this URI to get alle newsitems that were created in the last 6 months and the ‘id’ is selected.</p>
<pre tabindex="0"><code>_api/web/lists/SitePages/items?$filter=ContentType eq &#39;Site Page&#39; and PromotedState eq &#39;2&#39; and (Created ge datetime&#39;@{variables(&#39;PastHalfYear&#39;)}&#39;) and (Created le datetime&#39;@{formatDateTime(utcNow(),&#39;yyyy-MM-ddThh:MM&#39;)}&#39;)&amp;$select=id
</code></pre><p><img src="/images/20231021UserEngagement/Part1/5-HTTPGetNews.png" alt="HTTP get newsitems"></p>
<p>Count the total amount of items retrieved in the last step. And add a Parse JSON and use the body of the HTTP request.</p>
<p><img src="/images/20231021UserEngagement/Part1/6-amount.png" alt="Amount of newsitems"></p>
<h3 id="apply-to-each-newsitem">Apply to each newsitem</h3>
<p>The output will be used in the apply to each, so the statistics of each newsitem can be calculated correctly.</p>
<p><img src="/images/20231021UserEngagement/Part1/7-applytoeach.png" alt="Apply to each newsitem"></p>
<pre tabindex="0"><code>{ &#34;parameters&#34;: { &#34;ViewXml&#34;: &#34;&lt;View&gt;&lt;ViewFields&gt;&lt;FieldRef Name=\&#34;_LikeCount\&#34; /&gt;&lt;FieldRef Name=\&#34;_CommentCount\&#34; /&gt;&lt;/ViewFields&gt;&lt;Query&gt;&lt;Where&gt;&lt;Eq&gt;&lt;FieldRef Name=\&#34;ID\&#34;/&gt;&lt;Value Type=\&#34;Number\&#34;&gt;@{items(&#39;Apply_to_each&#39;)?[&#39;ID&#39;]}&lt;/Value&gt;&lt;/Eq&gt;&lt;/Where&gt;&lt;/Query&gt;&lt;RowLimit /&gt;&lt;/View&gt;&#34; } }
</code></pre><p>In the body the ID of the newsitem is used to get the _LikeCount and _CommentCount. Those values aren’t available by default.
The output of the HTTP request is used in the Parse JSON and using a compose the first result is detracted. Theoretically there can be more results, although we know it’s only one result, because of the unique ID.</p>
<p><img src="/images/20231021UserEngagement/Part1/8-compose.png" alt="Compose"></p>
<p>For every newsitem the correct variables will be set. When a newsitem didn’t get a like, the variable ‘NewsArticleNoLike’ will be incremented by 1. When a newsitem has likes, the variable ‘NewsArticleWithLike’ will be incremented by 1 and the total likes (variable NewsArticlesTotalLikes) will be incremented with the amount of likes.</p>
<p><img src="/images/20231021UserEngagement/Part1/9-conditionlikes.png" alt="Likes"></p>
<p><img src="/images/20231021UserEngagement/Part1/10-conditioncomments.png" alt="Comments"></p>
<h3 id="store-values-in-sharepoint-list">Store values in SharePoint list</h3>
<p>The results needs to be stored into a SharePoint list:</p>
<p><img src="/images/20231021UserEngagement/Part1/11-createitemSP.png" alt="SharePoint list create item"></p>
<p>The result of the SharePoint list:</p>
<p><img src="/images/20231021UserEngagement/Part1/12-sharepointlist.png" alt="SharePoint list"></p>
<p>So now you have insight into the half year statistics of your newsitems from your SharePoint Intranet.</p>

  </article>

  
<div class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'burgersandbytes';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



  
  
</div>

<div style="background: #92400E;">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
    <div>
      <div class="text-3xl font-bold mb-2">Empowering productivity - one blog at a time!</div>
      <p class="opacity-60"></p>
    </div>

    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2">
      

      
      <li>
        <a href="https://twitter.com/elianne_tweets" target="_blank" rel="noopener" aria-label="Twitter"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1668.56 1221.19" width="24" height="24"
            stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M283.94,167.31l386.39,516.64L281.5,1104h87.51l340.42-367.76L984.48,1104h297.8L874.15,558.3l361.92-390.99
  h-87.51l-313.51,338.7l-253.31-338.7H283.94z M412.63,231.77h136.81l604.13,807.76h-136.81L412.63,231.77z" />

          </svg>
        </a>
      </li>
      

      

      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a href="https://nl.linkedin.com/in/elianne-b-48946864" target="_blank" rel="noopener" aria-label="LinkedIn"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      


      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      


      
      <li>
        <a href="https://www.burgersandbytes.nl/index.xml" target="_blank" rel="noopener" aria-label="rss"
          class="p-1 inline-block rounded-full border border-transparent hover:border-black cursor-pointer transition-colors dark:hover:border-black">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="-125 -100 712 712" width="24" height="24"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">

          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
  <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"/>
<path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"/>
<path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"/>
        </svg>

        


        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright © 2024 - Elianne Burgers · All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12"  />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="//aseURL:1313/js/scripts.min.js"></script>


  







<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
